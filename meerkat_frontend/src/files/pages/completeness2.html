<div class="top-bar row">
  <div class="location-box box">
    <a href="#menu-toggle" id="menu-toggle">
      <div class="location-box__label">
        <div id="location_box"></div>
        <div id="location-title" class="location-title"></div>
      </div>
      <span class="glyphicon glyphicon-chevron-right"></span>
      <span class="glyphicon glyphicon-chevron-left hidden"></span>
    </a>
  </div>
  <div class="tab-title hidden-xs col-sm-5 col-md-5" id="title">
  </div>
  <div id="epi-week-title" class="col-xs-12 col-sm-4 col-md-3 pull-right box ">
  </div>
</div>

<div class="demographics toggled" id="wrapper">
  <div id="sidebar-wrapper" >
    <div id="location-selector" class="location-selector">
    </div>
	</div>

  <div id="page-content-wrapper">

    <div class="row">
      <div class="col-xs-12 col-md-4 less-padding-col">
        <div class="chartBox box">
          <div class="chartBox__heading">
            <span class="glossary capitalised" word="region" id="box_heading">Completeness in the last period</span>
            <div class="box__type-selector pull-right">
              <a href="" class="csv" onclick="exportTableToCSV('completeness-agg-table','completenessSummary.csv', this);" > 
                
              </a> 
            </div>
          </div>
          <div class="chartBox__content">
            <div id="completeness-table" class="table">
            </div>
          </div>
        </div>
      </div>


      <div class="col-xs-12 col-md-8 less-padding-col">
        <div class="chartBox box">
          <div class="chartBox__heading">
            <span class="glossary capitalised" word="region" id="box_heading">Completness in the last year</span>
          </div>
          <div class="chartBox__content">
            <div id="completeness-graph" style="margin: 0 auto"></div>
          </div>
        </div>
      </div>

    </div>

		<div class="row">
			<div class="col-xs-12 less-padding-col">
				<div class="chartBox box">
					<div class="chartBox__heading" id="box_2_heading">
            <span class="glossary capitalised" word="Non-reporting clinics" id="box_heading"></span>
            </div>
						<div class="box__type-selector pull-right">
							<a href="" class="csv" onclick="exportTableToCSV('completeness-table','completeness.csv', this);" > 
							</a> 
						</div>
					</div>
					<div class="chartBox__content">
						<div id="missing-completeness-table" class="table">
						</div>
					</div>
				</div>
			</div>
		</div>


		<div class="row">
			<div class="col-xs-12 less-padding-col">
				<div class="chartBox box">
					<div class="chartBox__heading" id="box_2_heading">
						<div class="box__type-selector pull-right">
							<a href="" class="csv" onclick="exportTableToCSV('completeness-table','completeness.csv', this);" > 
							</a> 
						</div>
					</div>
					<div class="chartBox__content">
						<div id="all-clinics-table" class="table">
              All clinics in this location with their completeness score. Can be hidden at first.
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>
</div>

<div class="breaker"></div>

<!-- Menu Toggle Script -->
<script>
 var currrentlocation;
 $("#location_box").html(i18n.gettext("Location:"));
 $("#location_title").html(i18n.gettext("Not Loaded"));
 $("#title").html(i18n.gettext('Completeness'));
 $("#epi-week-title").html(i18n.gettext('Date not loaded.'));
 $("#location-selector").html(i18n.gettext('Locations not loaded'));
 $("#box_heading").html(i18n.gettext('Regions'));
 $("#box_2_heading").html(i18n.gettext('Clinics'));
 $(".csv").each(function(){
	 $(this).html(i18n.gettext('Excel'));
 });
 
$("#menu-toggle").click(function(e) {
	e.preventDefault();
	$("#wrapper").toggleClass("toggled");
	$(".location-box .glyphicon").toggleClass( "hidden" );
	
	//Hack to resize highcharts upon side bar toggle. Call window resize() upon transition finish.
	var transitionEvent = whichTransitionEvent();
	transitionEvent && document.getElementById('sidebar-wrapper').addEventListener(transitionEvent, function() {
		$(window).resize();
	});
});

$("#epi-week-title").html( i18n.gettext("Week")+ " " +get_epi_week() + " Â· " + get_date() );
//Every tab needs a draw charts function that is called when loading a new location.
//It's also called upon the first load of the page. 
function drawCharts( locID ){
  currentLocation = locID;
  reDrawCompletness();
 }
     
 function reDrawCompletness(){
				drawCompletenessTable( 'completeness-table', currentLocation );
drawCompletenessGraph( 'completeness-graph', currentLocation );
drawMissingCompletenessTable( 'missing-completeness-table', currentLocation);
}



</script>
